<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>MerchantController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Payment Merchant Service</a> &gt; <a href="index.source.html" class="el_package">com.payment.merchant.controller</a> &gt; <span class="el_source">MerchantController.java</span></div><h1>MerchantController.java</h1><pre class="source lang-java linenums">package com.payment.merchant.controller;

import com.payment.common.result.Result;
import com.payment.common.constant.ErrorCodes;
import com.payment.merchant.dto.MerchantRegisterRequest;
import com.payment.merchant.dto.MerchantResponse;
import com.payment.merchant.dto.MerchantUpdateRequest;
import com.payment.merchant.service.MerchantService;
import io.swagger.annotations.Api;
import io.swagger.annotations.ApiOperation;
import io.swagger.annotations.ApiParam;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.validation.annotation.Validated;
import org.springframework.web.bind.annotation.*;

/**
 * 商户控制器
 *
 * @author Payment Platform Team
 * @since 1.0.0
 */
@Api(tags = &quot;商户管理&quot;)
<span class="fc" id="L24">@Slf4j</span>
@RestController
@RequestMapping(&quot;/api/merchants&quot;)
<span class="fc" id="L27">@RequiredArgsConstructor</span>
public class MerchantController {

    private final MerchantService merchantService;

    /**
     * 注册商户
     */
    @ApiOperation(value = &quot;注册商户&quot;, notes = &quot;注册新商户&quot;)
    @PostMapping(&quot;/register&quot;)
    public Result&lt;MerchantResponse&gt; registerMerchant(@ApiParam(value = &quot;商户注册请求&quot;, required = true) @Validated @RequestBody MerchantRegisterRequest request) {
<span class="fc" id="L38">        log.info(&quot;收到商户注册请求，商户名称：{}&quot;, request.getMerchantName());</span>
        
        try {
<span class="fc" id="L41">            MerchantResponse response = merchantService.registerMerchant(request);</span>
<span class="fc" id="L42">            return Result.success(response);</span>
<span class="fc" id="L43">        } catch (Exception e) {</span>
<span class="fc" id="L44">            log.error(&quot;商户注册失败&quot;, e);</span>
<span class="fc" id="L45">            return Result.fail(ErrorCodes.MERCHANT_REGISTER_FAILED, e.getMessage());</span>
        }
    }

    /**
     * 根据商户ID获取商户信息
     */
    @ApiOperation(value = &quot;根据商户ID获取商户信息&quot;, notes = &quot;通过商户ID获取商户详细信息&quot;)
    @GetMapping(&quot;/{merchantId}&quot;)
    public Result&lt;MerchantResponse&gt; getMerchantById(@ApiParam(value = &quot;商户ID&quot;, required = true) @PathVariable String merchantId) {
<span class="fc" id="L55">        log.info(&quot;获取商户信息，商户ID：{}&quot;, merchantId);</span>
        
        try {
<span class="fc" id="L58">            MerchantResponse response = merchantService.getMerchantById(merchantId);</span>
<span class="fc" id="L59">            return Result.success(response);</span>
<span class="fc" id="L60">        } catch (Exception e) {</span>
<span class="fc" id="L61">            log.error(&quot;获取商户信息失败&quot;, e);</span>
<span class="fc" id="L62">            return Result.fail(ErrorCodes.GET_MERCHANT_FAILED, e.getMessage());</span>
        }
    }

    /**
     * 根据商户编码获取商户信息
     */
    @ApiOperation(value = &quot;根据商户编码获取商户信息&quot;, notes = &quot;通过商户编码获取商户详细信息&quot;)
    @GetMapping(&quot;/code/{merchantCode}&quot;)
    public Result&lt;MerchantResponse&gt; getMerchantByCode(@ApiParam(value = &quot;商户编码&quot;, required = true) @PathVariable String merchantCode) {
<span class="fc" id="L72">        log.info(&quot;根据商户编码获取商户信息，商户编码：{}&quot;, merchantCode);</span>
        
        try {
<span class="fc" id="L75">            MerchantResponse response = merchantService.getMerchantByCode(merchantCode);</span>
<span class="fc" id="L76">            return Result.success(response);</span>
<span class="fc" id="L77">        } catch (Exception e) {</span>
<span class="fc" id="L78">            log.error(&quot;根据商户编码获取商户信息失败&quot;, e);</span>
<span class="fc" id="L79">            return Result.fail(ErrorCodes.GET_MERCHANT_BY_CODE_FAILED, e.getMessage());</span>
        }
    }

    /**
     * 更新商户信息
     */
    @ApiOperation(value = &quot;更新商户信息&quot;, notes = &quot;更新指定商户的信息&quot;)
    @PutMapping(&quot;/{merchantId}&quot;)
    public Result&lt;MerchantResponse&gt; updateMerchant(@ApiParam(value = &quot;商户ID&quot;, required = true) @PathVariable String merchantId, 
                                                   @ApiParam(value = &quot;商户更新请求&quot;, required = true) @Validated @RequestBody MerchantUpdateRequest request) {
<span class="fc" id="L90">        log.info(&quot;更新商户信息，商户ID：{}&quot;, merchantId);</span>
        
        try {
<span class="fc" id="L93">            MerchantResponse response = merchantService.updateMerchant(merchantId, request);</span>
<span class="fc" id="L94">            return Result.success(response);</span>
<span class="nc" id="L95">        } catch (Exception e) {</span>
<span class="nc" id="L96">            log.error(&quot;更新商户信息失败&quot;, e);</span>
<span class="nc" id="L97">            return Result.fail(ErrorCodes.UPDATE_MERCHANT_FAILED, e.getMessage());</span>
        }
    }

    /**
     * 删除商户
     */
    @ApiOperation(value = &quot;删除商户&quot;, notes = &quot;删除指定商户&quot;)
    @DeleteMapping(&quot;/{merchantId}&quot;)
    public Result&lt;Void&gt; deleteMerchant(@ApiParam(value = &quot;商户ID&quot;, required = true) @PathVariable String merchantId) {
<span class="fc" id="L107">        log.info(&quot;删除商户，商户ID：{}&quot;, merchantId);</span>
        
        try {
<span class="fc" id="L110">            merchantService.deleteMerchant(merchantId);</span>
<span class="fc" id="L111">            return Result.success();</span>
<span class="nc" id="L112">        } catch (Exception e) {</span>
<span class="nc" id="L113">            log.error(&quot;删除商户失败&quot;, e);</span>
<span class="nc" id="L114">            return Result.fail(ErrorCodes.DELETE_MERCHANT_FAILED, e.getMessage());</span>
        }
    }

    /**
     * 激活商户
     */
    @ApiOperation(value = &quot;激活商户&quot;, notes = &quot;激活指定商户&quot;)
    @PostMapping(&quot;/{merchantId}/activate&quot;)
    public Result&lt;Void&gt; activateMerchant(@ApiParam(value = &quot;商户ID&quot;, required = true) @PathVariable String merchantId) {
<span class="fc" id="L124">        log.info(&quot;激活商户，商户ID：{}&quot;, merchantId);</span>
        
        try {
<span class="fc" id="L127">            merchantService.activateMerchant(merchantId);</span>
<span class="fc" id="L128">            return Result.success();</span>
<span class="nc" id="L129">        } catch (Exception e) {</span>
<span class="nc" id="L130">            log.error(&quot;激活商户失败&quot;, e);</span>
<span class="nc" id="L131">            return Result.fail(ErrorCodes.ACTIVATE_MERCHANT_FAILED, e.getMessage());</span>
        }
    }

    /**
     * 停用商户
     */
    @ApiOperation(value = &quot;停用商户&quot;, notes = &quot;停用指定商户&quot;)
    @PostMapping(&quot;/{merchantId}/deactivate&quot;)
    public Result&lt;Void&gt; deactivateMerchant(@ApiParam(value = &quot;商户ID&quot;, required = true) @PathVariable String merchantId) {
<span class="fc" id="L141">        log.info(&quot;停用商户，商户ID：{}&quot;, merchantId);</span>
        
        try {
<span class="fc" id="L144">            merchantService.deactivateMerchant(merchantId);</span>
<span class="fc" id="L145">            return Result.success();</span>
<span class="nc" id="L146">        } catch (Exception e) {</span>
<span class="nc" id="L147">            log.error(&quot;停用商户失败&quot;, e);</span>
<span class="nc" id="L148">            return Result.fail(ErrorCodes.DEACTIVATE_MERCHANT_FAILED, e.getMessage());</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>